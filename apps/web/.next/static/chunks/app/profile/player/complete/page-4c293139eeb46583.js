(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[93,138],{8780:function(e,t,r){Promise.resolve().then(r.bind(r,7737))},7737:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var s=r(7573),i=r(7653),a=r(1695),l=r(7138),n=r(8113),o=r(3351),d=r(1306),c=r(466),u=r(9134),h=r(6529),m=r(7056);function f(e){let{currentImageUrl:t,onUploadComplete:r,bucket:a,folder:n="",maxSizeMB:o=5,acceptedTypes:d=["image/jpeg","image/jpg","image/png","image/webp"]}=e,[u,h]=(0,i.useState)(!1),[m,f]=(0,i.useState)(t||null),[p,x]=(0,i.useState)(null),g=(0,i.useRef)(null),b=async e=>{try{var s;x(null);let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!t)return;if(!d.includes(t.type)){x("Please upload a valid image file (".concat(d.map(e=>e.split("/")[1]).join(", "),")"));return}if(t.size/1048576>o){x("File size must be less than ".concat(o,"MB"));return}let i=new FileReader;i.onloadend=()=>{f(i.result)},i.readAsDataURL(t),h(!0);let c=(0,l.createClient)(),u=t.name.split(".").pop(),m="".concat(Math.random().toString(36).substring(2),"_").concat(Date.now(),".").concat(u),p=n?"".concat(n,"/").concat(m):m,{data:g,error:b}=await c.storage.from(a).upload(p,t,{cacheControl:"3600",upsert:!1});if(b)throw b;let{data:{publicUrl:j}}=c.storage.from(a).getPublicUrl(g.path);r(j)}catch(e){console.error("Upload error:",e),x(e instanceof Error?e.message:"Failed to upload image"),f(t||null)}finally{h(!1)}};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[m?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:m,alt:"Profile preview",className:"w-32 h-32 object-cover rounded-full border-4 border-slate-200"}),!u&&(0,s.jsx)("button",{onClick:()=>{f(null),r(""),g.current&&(g.current.value="")},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",type:"button",children:"\xd7"})]}):(0,s.jsx)("div",{className:"w-32 h-32 rounded-full border-4 border-dashed border-slate-300 flex items-center justify-center bg-slate-50",children:(0,s.jsx)("svg",{className:"w-12 h-12 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)("input",{ref:g,type:"file",accept:d.join(","),onChange:b,disabled:u,className:"hidden",id:"photo-upload"}),(0,s.jsx)("label",{htmlFor:"photo-upload",children:(0,s.jsx)(c.z,{type:"button",variant:"outline",size:"sm",disabled:u,onClick:()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.click()},asChild:!0,children:(0,s.jsx)("span",{children:u?"Uploading...":m?"Change Photo":"Upload Photo"})})}),(0,s.jsxs)("p",{className:"text-xs text-slate-500 text-center",children:["Max ",o,"MB â€¢ JPG, PNG, WebP"]})]})]}),p&&(0,s.jsx)("div",{className:"text-sm text-red-600 text-center bg-red-50 p-2 rounded",children:p})]})}let p=["Goalkeeper","Defender","Midfielder","Forward","Winger"],x=["Left","Right","Both"],g=d.Ryn({position:d.KmV(p).catch("Midfielder"),jersey_number:d.Z_8().optional(),date_of_birth:d.Z_8().min(1,"Date of birth is required"),nationality:d.Z_8().min(2,"Nationality is required"),address:d.Z_8().min(5,"Address is required"),district:d.Z_8().min(2,"District is required"),state:d.Z_8().min(2,"State is required"),height_cm:d.Z_8().min(1,"Height is required"),weight_kg:d.Z_8().min(1,"Weight is required"),preferred_foot:d.KmV(x).catch("Right"),bio:d.Z_8().optional()});function b(){let e=(0,a.useRouter)(),[t,r]=(0,i.useState)(null),[d,b]=(0,i.useState)(!1),[j,v]=(0,i.useState)(!0),[y,_]=(0,i.useState)(""),{register:N,handleSubmit:w,formState:{errors:k},reset:I}=(0,o.cI)({resolver:(0,n.F)(g)});(0,i.useEffect)(()=>{(async()=>{try{let n=(0,l.createClient)(),{data:{user:o}}=await n.auth.getUser();if(!o)return;let{data:d}=await n.from("players").select("*, users!inner(bio)").eq("user_id",o.id).single();if(d){var e,t,r,s,i,a;I({position:d.position,jersey_number:(null===(e=d.jersey_number)||void 0===e?void 0:e.toString())||"",date_of_birth:d.date_of_birth||"",nationality:d.nationality||"",address:d.address||"",district:d.district||"",state:d.state||"",height_cm:(null===(t=d.height_cm)||void 0===t?void 0:t.toString())||"",weight_kg:(null===(r=d.weight_kg)||void 0===r?void 0:r.toString())||"",preferred_foot:(null===(s=d.preferred_foot)||void 0===s?void 0:s.charAt(0).toUpperCase())+(null===(i=d.preferred_foot)||void 0===i?void 0:i.slice(1)),bio:(null===(a=d.users)||void 0===a?void 0:a.bio)||""}),_(d.photo_url||"")}}catch(e){console.error("Error loading player data:",e)}finally{v(!1)}})()},[I]);let C=async t=>{try{r(null),b(!0);let s=(0,l.createClient)(),{data:{user:i}}=await s.auth.getUser();if(!i){r("Not authenticated");return}if(!y){r("Profile photo is required. Please upload a photo before submitting."),b(!1);return}let a="PCL-P-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9).toUpperCase()),{data:n}=await s.from("players").select("id").eq("user_id",i.id).single();if(n){let{error:e}=await s.from("players").update({photo_url:y,position:t.position,jersey_number:t.jersey_number?parseInt(t.jersey_number):null,date_of_birth:t.date_of_birth,nationality:t.nationality,address:t.address,district:t.district,state:t.state,height_cm:parseFloat(t.height_cm),weight_kg:parseFloat(t.weight_kg),preferred_foot:t.preferred_foot.toLowerCase(),is_available_for_scout:!1,updated_at:new Date().toISOString()}).eq("user_id",i.id);if(e){r(e.message);return}}else{let{error:e}=await s.from("players").insert({user_id:i.id,unique_player_id:a,photo_url:y,position:t.position,jersey_number:t.jersey_number?parseInt(t.jersey_number):null,date_of_birth:t.date_of_birth,nationality:t.nationality,address:t.address,district:t.district,state:t.state,height_cm:parseFloat(t.height_cm),weight_kg:parseFloat(t.weight_kg),preferred_foot:t.preferred_foot.toLowerCase(),is_available_for_scout:!1});if(e){r(e.message);return}}t.bio&&await s.from("users").update({bio:t.bio}).eq("id",i.id),e.push("/dashboard/player")}catch(e){r(e instanceof Error?e.message:"An error occurred")}finally{b(!1)}};return j?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("div",{className:"text-slate-600",children:"Loading profile..."})}):(0,s.jsxs)("form",{onSubmit:w(C),className:"space-y-6",children:[t&&(0,s.jsx)(m.bZ,{variant:"destructive",children:t}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h._,{className:"text-center block",children:"Profile Photo *"}),(0,s.jsx)("div",{className:"flex justify-center py-4",children:(0,s.jsx)(f,{currentImageUrl:y,onUploadComplete:_,bucket:"player-photos",folder:"profiles",maxSizeMB:5})}),(0,s.jsx)("p",{className:"text-xs text-slate-500 text-center",children:"Profile photo is required for player identification and verification"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h._,{htmlFor:"position",children:"Playing Position *"}),(0,s.jsxs)("select",{id:"position",...N("position"),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"Select position"}),p.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),k.position&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.position.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h._,{htmlFor:"jersey_number",children:"Jersey Number (Optional)"}),(0,s.jsx)(u.I,{id:"jersey_number",type:"number",min:"1",max:"99",placeholder:"e.g., 10",...N("jersey_number")}),k.jersey_number&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.jersey_number.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h._,{htmlFor:"date_of_birth",children:"Date of Birth *"}),(0,s.jsx)(u.I,{id:"date_of_birth",type:"date",...N("date_of_birth")}),k.date_of_birth&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.date_of_birth.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h._,{htmlFor:"nationality",children:"Nationality *"}),(0,s.jsx)(u.I,{id:"nationality",type:"text",placeholder:"e.g., Indian",...N("nationality")}),k.nationality&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.nationality.message})]}),(0,s.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,s.jsx)(h._,{htmlFor:"address",children:"Address *"}),(0,s.jsx)(u.I,{id:"address",type:"text",placeholder:"House/Flat No., Street, Area",...N("address")}),k.address&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.address.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h._,{htmlFor:"district",children:"District *"}),(0,s.jsx)(u.I,{id:"district",type:"text",placeholder:"e.g., Kasaragod",...N("district")}),k.district&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.district.message}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Used for District Qualifier Level (DQL) tournaments"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h._,{htmlFor:"state",children:"State *"}),(0,s.jsx)(u.I,{id:"state",type:"text",placeholder:"e.g., Kerala",...N("state")}),k.state&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.state.message}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Required for state and national level leagues"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h._,{htmlFor:"height_cm",children:"Height (cm) *"}),(0,s.jsx)(u.I,{id:"height_cm",type:"number",min:"100",max:"250",placeholder:"e.g., 175",...N("height_cm")}),k.height_cm&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.height_cm.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h._,{htmlFor:"weight_kg",children:"Weight (kg) *"}),(0,s.jsx)(u.I,{id:"weight_kg",type:"number",min:"30",max:"150",placeholder:"e.g., 70",...N("weight_kg")}),k.weight_kg&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.weight_kg.message})]}),(0,s.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,s.jsx)(h._,{htmlFor:"preferred_foot",children:"Preferred Foot *"}),(0,s.jsxs)("select",{id:"preferred_foot",...N("preferred_foot"),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"Select preferred foot"}),x.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),k.preferred_foot&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.preferred_foot.message})]}),(0,s.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,s.jsx)(h._,{htmlFor:"bio",children:"Bio (Optional)"}),(0,s.jsx)("textarea",{id:"bio",rows:4,placeholder:"Tell us about yourself, your playing style, achievements...",...N("bio"),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),k.bio&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:k.bio.message})]})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(c.z,{type:"submit",disabled:d,className:"flex-1",children:d?"Saving...":"Save Profile"}),(0,s.jsx)(c.z,{type:"button",variant:"outline",onClick:()=>e.push("/dashboard/player"),disabled:d,children:"Cancel"})]})]})}function j(){let e=(0,a.useRouter)(),[t,r]=(0,i.useState)(!0),[n,o]=(0,i.useState)(null);return((0,i.useEffect)(()=>{let t=(0,l.createClient)();(async()=>{try{let{data:{user:r}}=await t.auth.getUser();if(!r){e.push("/auth/login");return}let{data:s}=await t.from("users").select("role").eq("id",r.id).single();if((null==s?void 0:s.role)!=="player"){e.push("/dashboard");return}o(r)}catch(t){console.error("Error checking auth:",t),e.push("/auth/login")}finally{r(!1)}})()},[e]),t||!n)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-slate-600",children:"Loading..."})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:[(0,s.jsx)("nav",{className:"bg-white border-b border-slate-200 shadow-sm",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"flex justify-between items-center h-16",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:"/logo.png",alt:"PCL Logo",className:"h-10 w-10"}),(0,s.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-blue-700 bg-clip-text text-transparent",children:"PCL"})]})})})}),(0,s.jsx)("main",{className:"max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 md:p-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Complete Your Player Profile"}),(0,s.jsx)("p",{className:"text-slate-600",children:"Fill in your details to appear in scout searches and receive contract offers"})]}),(0,s.jsx)(b,{})]})})]})}},7056:function(e,t,r){"use strict";r.d(t,{Cd:function(){return d},X:function(){return c},bZ:function(){return o}});var s=r(7573),i=r(7653),a=r(9289),l=r(9147);let n=(0,a.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-red-500/50 text-red-600 dark:border-red-500 [&>svg]:text-red-600",success:"border-green-500/50 text-green-600 dark:border-green-500 [&>svg]:text-green-600",warning:"border-yellow-500/50 text-yellow-600 dark:border-yellow-500 [&>svg]:text-yellow-600"}},defaultVariants:{variant:"default"}}),o=i.forwardRef((e,t)=>{let{className:r,variant:i,...a}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,l.cn)(n({variant:i}),r),...a})});o.displayName="Alert";let d=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,s.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",r),...i})});d.displayName="AlertTitle";let c=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",r),...i})});c.displayName="AlertDescription"},466:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var s=r(7573),i=r(7653),a=r(5814),l=r(9289),n=r(9147);let o=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef((e,t)=>{let{className:r,variant:i,size:l,asChild:d=!1,...c}=e,u=d?a.g7:"button";return(0,s.jsx)(u,{className:(0,n.cn)(o({variant:i,size:l,className:r})),ref:t,...c})});d.displayName="Button"},9134:function(e,t,r){"use strict";r.d(t,{I:function(){return l}});var s=r(7573),i=r(7653),a=r(9147);let l=i.forwardRef((e,t)=>{let{className:r,type:i,...l}=e;return(0,s.jsx)("input",{type:i,className:(0,a.cn)("flex h-10 w-full rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-800 dark:bg-slate-950 dark:ring-offset-slate-950 dark:placeholder:text-slate-400 dark:focus-visible:ring-slate-300",r),ref:t,...l})});l.displayName="Input"},6529:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var s=r(7573),i=r(7653),a=r(3972),l=r(9289),n=r(9147);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,s.jsx)(a.f,{ref:t,className:(0,n.cn)(o(),r),...i})});d.displayName=a.f.displayName},7138:function(e,t,r){"use strict";r.d(t,{createClient:function(){return i}});var s=r(845);let i=()=>(0,s.createBrowserClient)("https://uvifkmkdoiohqrdbwgzt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV2aWZrbWtkb2lvaHFyZGJ3Z3p0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYwNTA0MjMsImV4cCI6MjA4MTYyNjQyM30.fbFwh2HBKd4pjImw88hhG4-VuBxWaLDoIpcpZvjHD3o")},9147:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var s=r(607),i=r(5579);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.m6)((0,s.W)(t))}},1695:function(e,t,r){"use strict";var s=r(1219);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[845,494,589,293,528,744],function(){return e(e.s=8780)}),_N_E=e.O()}]);