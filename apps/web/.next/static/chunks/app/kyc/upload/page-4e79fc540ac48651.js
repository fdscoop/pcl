(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[802],{3810:function(e,t,r){Promise.resolve().then(r.bind(r,2944))},2944:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var a=r(7573),s=r(7653),l=r(1695),i=r(7138),n=r(466),o=r(9134),d=r(6529),u=r(7056),c=r(2196);let f=[{value:"national_id",label:"National ID Card",required:!0},{value:"passport",label:"Passport",required:!1},{value:"drivers_license",label:"Driver's License",required:!1},{value:"proof_of_address",label:"Proof of Address (Utility Bill)",required:!0},{value:"birth_certificate",label:"Birth Certificate",required:!1},{value:"other",label:"Other Document",required:!1}];function p(){let e=(0,l.useRouter)(),[t,r]=(0,s.useState)(null),[p,m]=(0,s.useState)(null),[x,b]=(0,s.useState)(!1),[v,h]=(0,s.useState)([{type:"national_id",file:null,preview:null,number:"",expiryDate:""},{type:"proof_of_address",file:null,preview:null,number:"",expiryDate:""}]),g=(e,t)=>{if(!t)return;if(t.size>5242880){r("File size must be less than 5MB");return}if(!["image/jpeg","image/jpg","image/png","application/pdf"].includes(t.type)){r("File must be JPG, PNG, or PDF");return}r(null);let a=[...v];if(a[e].file=t,t.type.startsWith("image/")){let r=new FileReader;r.onloadend=()=>{a[e].preview=r.result,h(a)},r.readAsDataURL(t)}else a[e].preview=null,h(a)},y=e=>{h(v.filter((t,r)=>r!==e))},j=async t=>{t.preventDefault(),r(null),m(null),b(!0);try{let t=(0,i.e)(),{data:{user:a}}=await t.auth.getUser();if(!a){r("Not authenticated");return}let s=v.some(e=>"national_id"===e.type&&e.file),l=v.some(e=>"proof_of_address"===e.type&&e.file);if(!s){r("National ID is required");return}if(!l){r("Proof of Address is required");return}for(let e of v){if(!e.file)continue;let s=e.file.name.split(".").pop(),l="".concat(a.id,"/").concat(e.type,"_").concat(Date.now(),".").concat(s),{error:i}=await t.storage.from("kyc-documents").upload(l,e.file,{cacheControl:"3600",upsert:!1});if(i){r("Upload failed for ".concat(e.type,": ").concat(i.message));return}let{data:{publicUrl:n}}=t.storage.from("kyc-documents").getPublicUrl(l),{error:o}=await t.from("kyc_documents").insert({user_id:a.id,document_type:e.type,document_number:e.number||null,document_url:l,expires_at:e.expiryDate||null,status:"pending"});if(o){r("Database error for ".concat(e.type,": ").concat(o.message));return}}await t.from("users").update({kyc_status:"pending"}).eq("id",a.id),m("KYC documents uploaded successfully! Your submission is under review."),setTimeout(()=>{e.push("/dashboard/player")},2e3)}catch(e){r(e instanceof Error?e.message:"An error occurred")}finally{b(!1)}};return(0,a.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[t&&(0,a.jsx)(u.bZ,{variant:"destructive",children:t}),p&&(0,a.jsx)(u.bZ,{variant:"success",children:p}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-blue-900 mb-2",children:"Required Documents"}),(0,a.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,a.jsx)("li",{children:"• National ID Card (mandatory)"}),(0,a.jsx)("li",{children:"• Proof of Address - Utility bill, bank statement (mandatory)"}),(0,a.jsx)("li",{children:"• Additional documents are optional"}),(0,a.jsx)("li",{children:"• File size: Max 5MB per file"}),(0,a.jsx)("li",{children:"• Formats: JPG, PNG, PDF"})]})]}),v.map((e,t)=>{var r,s,l;return(0,a.jsxs)(c.Zb,{className:"border-2",children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(c.ll,{className:"text-lg",children:[null===(r=f.find(t=>t.value===e.type))||void 0===r?void 0:r.label,(null===(s=f.find(t=>t.value===e.type))||void 0===s?void 0:s.required)&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,a.jsx)(c.SZ,{children:"Upload a clear photo or scan of your document"})]}),t>=2&&(0,a.jsx)(n.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>y(t),children:"Remove"})]})}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[t>=2&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{children:"Document Type"}),(0,a.jsx)("select",{value:e.type,onChange:e=>{let r=[...v];r[t].type=e.target.value,h(r)},className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:f.filter(e=>!e.required).map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{children:"Upload Document"}),(0,a.jsx)(o.I,{type:"file",accept:"image/jpeg,image/jpg,image/png,application/pdf",onChange:e=>{var r;return g(t,(null===(r=e.target.files)||void 0===r?void 0:r[0])||null)},required:null===(l=f.find(t=>t.value===e.type))||void 0===l?void 0:l.required}),e.preview&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("img",{src:e.preview,alt:"Document preview",className:"max-w-xs h-auto rounded border"})}),e.file&&!e.preview&&(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["\uD83D\uDCC4 ",e.file.name," (",(e.file.size/1024/1024).toFixed(2)," MB)"]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{children:"Document Number (Optional)"}),(0,a.jsx)(o.I,{type:"text",placeholder:"e.g., ID123456789",value:e.number,onChange:e=>{let r=[...v];r[t].number=e.target.value,h(r)}})]}),"proof_of_address"!==e.type&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{children:"Expiry Date (Optional)"}),(0,a.jsx)(o.I,{type:"date",value:e.expiryDate,onChange:e=>{let r=[...v];r[t].expiryDate=e.target.value,h(r)},min:new Date().toISOString().split("T")[0]})]})]})]},t)}),(0,a.jsx)("div",{className:"flex gap-4",children:(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:()=>{h([...v,{type:"other",file:null,preview:null,number:"",expiryDate:""}])},disabled:x,children:"+ Add Another Document"})}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(n.z,{type:"submit",disabled:x,className:"flex-1",children:x?"Uploading...":"Submit for Verification"}),(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:()=>e.push("/dashboard/player"),disabled:x,children:"Cancel"})]})]})}function m(){let e=(0,l.useRouter)(),[t,r]=(0,s.useState)(!0),[n,o]=(0,s.useState)(null);return((0,s.useEffect)(()=>{let t=(0,i.e)();(async()=>{try{let{data:{user:r}}=await t.auth.getUser();if(!r){e.push("/auth/login");return}let{data:a}=await t.from("users").select("role, kyc_status").eq("id",r.id).single();if((null==a?void 0:a.role)!=="player"){e.push("/dashboard");return}if((null==a?void 0:a.kyc_status)==="verified"){e.push("/dashboard/player");return}o(r)}catch(t){console.error("Error checking auth:",t),e.push("/auth/login")}finally{r(!1)}})()},[e]),t)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-slate-600",children:"Loading..."})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:[(0,a.jsx)("nav",{className:"bg-white border-b border-slate-200 shadow-sm",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"flex justify-between items-center h-16",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("img",{src:"/logo.png",alt:"PCL Logo",className:"h-10 w-10"}),(0,a.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-blue-700 bg-clip-text text-transparent",children:"PCL"})]})})})}),(0,a.jsx)("main",{className:"max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 md:p-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"KYC Verification"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Upload your identification documents to get verified and appear in club searches"})]}),(0,a.jsx)(p,{})]})})]})}},7056:function(e,t,r){"use strict";r.d(t,{Cd:function(){return d},X:function(){return u},bZ:function(){return o}});var a=r(7573),s=r(7653),l=r(9289),i=r(9147);let n=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-red-500/50 text-red-600 dark:border-red-500 [&>svg]:text-red-600",success:"border-green-500/50 text-green-600 dark:border-green-500 [&>svg]:text-green-600",warning:"border-yellow-500/50 text-yellow-600 dark:border-yellow-500 [&>svg]:text-yellow-600"}},defaultVariants:{variant:"default"}}),o=s.forwardRef((e,t)=>{let{className:r,variant:s,...l}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(n({variant:s}),r),...l})});o.displayName="Alert";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",r),...s})});d.displayName="AlertTitle";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",r),...s})});u.displayName="AlertDescription"},466:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var a=r(7573),s=r(7653),l=r(5814),i=r(9289),n=r(9147);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:d=!1,...u}=e,c=d?l.g7:"button";return(0,a.jsx)(c,{className:(0,n.cn)(o({variant:s,size:i,className:r})),ref:t,...u})});d.displayName="Button"},2196:function(e,t,r){"use strict";r.d(t,{Ol:function(){return n},SZ:function(){return d},Zb:function(){return i},aY:function(){return u},eW:function(){return c},ll:function(){return o}});var a=r(7573),s=r(7653),l=r(9147);let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border border-slate-200 bg-white text-slate-950 shadow-sm dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50",r),...s})});i.displayName="Card";let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...s})});n.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h2",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-slate-500 dark:text-slate-400",r),...s})});d.displayName="CardDescription";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",r),...s})});u.displayName="CardContent";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",r),...s})});c.displayName="CardFooter"},9134:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var a=r(7573),s=r(7653),l=r(9147);let i=s.forwardRef((e,t)=>{let{className:r,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,l.cn)("flex h-10 w-full rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-800 dark:bg-slate-950 dark:ring-offset-slate-950 dark:placeholder:text-slate-400 dark:focus-visible:ring-slate-300",r),ref:t,...i})});i.displayName="Input"},6529:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var a=r(7573),s=r(7653),l=r(3972),i=r(9289),n=r(9147);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(l.f,{ref:t,className:(0,n.cn)(o(),r),...s})});d.displayName=l.f.displayName},7138:function(e,t,r){"use strict";r.d(t,{e:function(){return s}});var a=r(845);let s=()=>(0,a.createBrowserClient)("https://uvifkmkdoiohqrdbwgzt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV2aWZrbWtkb2lvaHFyZGJ3Z3p0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYwNTA0MjMsImV4cCI6MjA4MTYyNjQyM30.fbFwh2HBKd4pjImw88hhG4-VuBxWaLDoIpcpZvjHD3o")},9147:function(e,t,r){"use strict";r.d(t,{cn:function(){return l}});var a=r(607),s=r(5579);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}},1695:function(e,t,r){"use strict";var a=r(1219);r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},3972:function(e,t,r){"use strict";r.d(t,{f:function(){return o}});var a=r(7653);r(3458);var s=r(5814),l=r(7573),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,s.Z8)(`Primitive.${t}`),i=a.forwardRef((e,a)=>{let{asChild:s,...i}=e,n=s?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(n,{...i,ref:a})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{}),n=a.forwardRef((e,t)=>(0,l.jsx)(i.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var o=n}},function(e){e.O(0,[845,494,293,528,744],function(){return e(e.s=3810)}),_N_E=e.O()}]);